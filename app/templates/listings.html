{% extends 'base.html' %}
{% block title %}Geplande Leveringen — Delivery Schedule{% endblock %}

{% block content %}
<div class="page-header flex justify-between items-center">
  <div>
    <h1 class="page-title">Geplande Leveringen</h1>
    <p class="page-subtitle">Overzicht van alle geplande en uitgevoerde leveringen.</p>
  </div>
  <div class="flex gap-2">
    <a href="{{ url_for('main.export_deliveries_ical') }}" class="btn btn-outline" title="Exporteer naar Apple Calendar, Google Calendar, Outlook, etc.">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="16" y1="2" x2="16" y2="6"></line>
        <line x1="8" y1="2" x2="8" y2="6"></line>
        <line x1="3" y1="10" x2="21" y2="10"></line>
      </svg>
      Exporteer naar Kalender
    </a>
    <a href="{{ url_for('main.add_listing') }}" class="btn btn-primary">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 5v14M5 12h14"/>
      </svg>
      Levering Plannen
    </a>
  </div>
</div>

{% if listings %}
  <div class="table-container">
    <table class="table">
      <thead>
        <tr>
          <th>Gemeente</th>
          <th>Product Omschrijving</th>
          <th>Status</th>
          <th>Geplande Datum</th>
          <th class="text-center">Acties</th>
        </tr>
      </thead>
      <tbody>
        {% for listing in listings %}
          <tr>
            <td class="font-medium">{{ listing.municipality or '—' }}</td>
            <td>
              <span class="font-medium">{{ listing.product_description or '—' }}</span>
            </td>
            <td>
              <span class="badge {% if listing.status == 'scheduled' %}badge-primary{% elif listing.status == 'delivered' %}badge-success{% else %}badge-default{% endif %}">
                {{ listing.status }}
              </span>
            </td>
            <td>
              {% if listing.scheduled_date %}
                {{ listing.scheduled_date.strftime('%d-%m-%Y') }}
              {% else %}
                <span class="text-muted">—</span>
              {% endif %}
            </td>
            <td class="text-center">
              <form method="POST" action="{{ url_for('main.delete_delivery', delivery_id=listing.delivery_id) }}" style="display: inline;" onsubmit="return confirm('Weet je zeker dat je deze levering wilt verwijderen?');">
                <button type="submit" class="btn btn-danger btn-sm">Verwijderen</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <div class="card-footer">
      <p class="text-small text-muted">Totaal: <strong>{{ listings | length }}</strong> levering{% if listings | length != 1 %}en{% endif %}</p>
    </div>
  </div>
{% else %}
  <div class="card">
    <div class="empty-state">
      <svg class="empty-state-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
        <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 00-3.213-9.193 2.056 2.056 0 00-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 00-10.026 0 1.106 1.106 0 00-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12" />
      </svg>
      <p class="empty-state-title">Geen leveringen gevonden</p>
      <p class="empty-state-text">Er zijn nog geen leveringen gepland. Plan je eerste levering om te beginnen.</p>
      <a href="{{ url_for('main.add_listing') }}" class="btn btn-primary mt-4">Levering Plannen</a>
    </div>
  </div>
{% endif %}
{% endblock %}

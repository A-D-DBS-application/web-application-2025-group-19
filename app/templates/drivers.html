{% extends 'base.html' %}
{% block title %}Chauffeurs — Delivery Schedule{% endblock %}

{% block content %}
<div class="page-header">
  <h1 class="page-title">Chauffeurs</h1>
  <p class="page-subtitle">Beheer je team van chauffeurs en hun beschikbaarheid.</p>
</div>

<!-- Chauffeur Toevoegen -->
<div class="card mb-5">
  <div class="card-header">
    <h2 class="font-semibold flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M19 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zM4 19.235v-.11a6.375 6.375 0 0112.75 0v.109A12.318 12.318 0 0110.374 21c-2.331 0-4.512-.645-6.374-1.766z" />
      </svg>
      Chauffeur Toevoegen
    </h2>
  </div>
  <div class="card-body">
    <form method="POST" action="{{ url_for('main.add_driver') }}">
      <div class="grid grid-cols-2 gap-4">
        <div class="form-group">
          <label class="form-label">Voornaam</label>
          <input type="text" name="first_name" placeholder="Jan" class="form-input" required>
        </div>
        <div class="form-group">
          <label class="form-label">Achternaam</label>
          <input type="text" name="last_name" placeholder="Janssen" class="form-input" required>
        </div>
        <div class="form-group">
          <label class="form-label">E-mailadres</label>
          <input type="email" name="email" placeholder="jan.janssen@bedrijf.be" class="form-input" required>
        </div>
        <div class="form-group">
          <label class="form-label">Beschikbaarheidsdatum</label>
          <input type="date" name="availability_date" class="form-input">
        </div>
      </div>
      <div class="mt-4">
        <button type="submit" class="btn btn-primary">Chauffeur toevoegen</button>
      </div>
    </form>
  </div>
</div>

<div class="divider"></div>

<!-- Overzicht Chauffeurs -->
<div class="table-container">
  <div class="card-header flex justify-between items-center">
    <div>
      <h2 class="font-semibold flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
        </svg>
        Overzicht Chauffeurs
      </h2>
      {% if drivers %}
        <p class="text-small text-muted mt-1">{{ drivers | length }} chauffeur{% if drivers | length != 1 %}s{% endif %} actief</p>
      {% endif %}
    </div>
  </div>

  {% if drivers %}
    <table class="table">
      <thead>
        <tr>
          <th>Naam</th>
          <th>E-mailadres</th>
          <th>Beschikbaarheid</th>
          <th>ID</th>
          <th class="text-center">Acties</th>
        </tr>
      </thead>
      <tbody>
        {% for driver in drivers %}
          <tr>
            <td>
              <div class="flex items-center gap-2">
                <div style="width: 32px; height: 32px; border-radius: 50%; background: var(--color-navy); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 600;">
                  {{ driver.name[0] | upper }}
                </div>
                <span class="font-medium">{{ driver.name }}</span>
              </div>
            </td>
            <td>{{ driver.email or '—' }}</td>
            <td>
              {% if driver.available_today %}
                <span class="badge badge-success">Beschikbaar vandaag</span>
              {% else %}
                <span class="text-muted">{{ driver.available_date }}</span>
              {% endif %}
            </td>
            <td>
              <code style="font-family: monospace; background: rgba(0,0,0,0.04); padding: 2px 6px; border-radius: 4px; font-size: 0.75rem;">#{{ driver.employee_id }}</code>
            </td>
            <td class="text-center">
              <div class="flex justify-center gap-2">
                <a href="{{ url_for('main.export_driver_schedule_ical', employee_id=driver.employee_id) }}" class="btn btn-ghost btn-sm" title="Exporteer schema naar kalender (.ics)">
                  <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                  </svg>
                </a>
                <form method="POST" action="{{ url_for('main.delete_driver', employee_id=driver.employee_id) }}" style="display: inline;" onsubmit="return confirm('Weet je zeker dat je deze chauffeur wilt verwijderen?');">
                  <button type="submit" class="btn btn-danger btn-sm">Verwijderen</button>
                </form>
              </div>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <div class="empty-state">
      <svg class="empty-state-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
      </svg>
      <p class="empty-state-title">Er zijn nog geen chauffeurs geregistreerd.</p>
      <p class="empty-state-text">Voeg een chauffeur toe via het formulier hierboven.</p>
    </div>
  {% endif %}
</div>
{% endblock %}
